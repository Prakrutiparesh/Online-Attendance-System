<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title>Course-wise Division Management</title>
        <link href="CSS/showSemester.css" rel="stylesheet" type="text/css"/>
    </h:head>

    <h:body>

        <h:form id="divisionForm">

            <h2>Select Course</h2>
            <h:selectOneMenu value="#{updateCDIBean.selectedCourseId}" styleClass="menu">
                <f:selectItem itemLabel="--Select Course--" itemValue="" />
                <f:selectItems value="#{updateCDIBean.courseList}" var="c"
                               itemValue="#{c.courseId}" itemLabel="#{c.courseName}" />
                <f:ajax listener="#{updateCDIBean.loadSemesters()}" render="semesterPanel" />
            </h:selectOneMenu>

            <br/><br/>

            <h:panelGroup id="semesterPanel">
                <h:panelGroup rendered="#{not empty updateCDIBean.semesterList}">
                    <h2>Select Semester</h2>
                    <h:selectOneMenu value="#{updateCDIBean.selectedSemId}" styleClass="menu">
                        <f:selectItem itemLabel="--Select Semester--" itemValue="" />
                        <f:selectItems value="#{updateCDIBean.semesterList}" var="s"
                                       itemValue="#{s.semId}" itemLabel="#{s.semName}" />
                        <f:ajax listener="#{updateCDIBean.loadDivisions()}" render="divisionPanel" />
                    </h:selectOneMenu>
                </h:panelGroup>
            </h:panelGroup>

            <br/>

            <h:panelGroup id="divisionPanel">
                <h:panelGroup rendered="#{not empty updateCDIBean.divisionList}">
                    <h2>Divisions in Selected Semester</h2>

                    <h:dataTable id="divisionTable" value="#{updateCDIBean.divisionList}" var="d">

                        <h:column>
                            <f:facet name="header">Division ID</f:facet>
                                #{d.divId}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Division Name</f:facet>
                                #{d.divName}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Actions</f:facet>

                            <h:commandButton value="Update"
                                             action="#{updateCDIBean.editDivision(d.divId, d.divName)}">
                                <f:ajax execute="@this" render=":updateForm" />
                            </h:commandButton>

                            <h:commandButton value="Delete"
                                             action="#{updateCDIBean.deleteDivision(d.divId)}">
                                <f:ajax execute="@form" render="@form" />
                            </h:commandButton>

                        </h:column>

                    </h:dataTable>

                </h:panelGroup>

                <h:panelGroup rendered="#{empty updateCDIBean.divisionList}">
                    <h3 style="text-align:center; color:#777; margin-top:20px;">
                        No Divisions Found
                    </h3>
                </h:panelGroup>
            </h:panelGroup>

        </h:form>




        <!-- POPUP FORM -->
        <h:panelGroup id="updateForm">
            <h:panelGroup rendered="#{updateCDIBean.showUpdateForm}">
                <div class="popup-overlay">
                    <div class="popup-box">

                        <h2 class="popup-heading">Update Division</h2>

                        <h:form id="updatePopupForm">

                            <div style="text-align: left; margin-bottom: 5px;">Division ID</div>
                            <h:inputText readonly="true"
                                         value="#{updateCDIBean.updateDivId}"
                                         class="popup-input"/>

                            <div style="text-align: left; margin-bottom: 5px;">Division Name</div>
                            <h:inputText value="#{updateCDIBean.updateDivName}"
                                         class="popup-input"/>

                            <div class="btn-container">
                                <h:commandButton value="Save Update"
                                                 styleClass="save-btn"
                                                 action="#{updateCDIBean.saveUpdate()}">
                                    <f:ajax execute="@form"
                                            render=":divisionForm:divisionPanel :updateForm"/>
                                </h:commandButton>

                                <h:commandButton value="Cancel"
                                                 styleClass="cancel-btn"
                                                 action="#{updateCDIBean.cancelPopup()}">
                                    <f:ajax execute="@this" render=":updateForm" />
                                </h:commandButton>
                            </div>

                        </h:form>

                    </div>
                </div>
            </h:panelGroup>
        </h:panelGroup>


    </h:body>
</html>
